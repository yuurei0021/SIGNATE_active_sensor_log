# Gravity Investigation - Why Gravity is Invisible During Motion

## 背景と疑問
実験20251120_03で、idle時には重力加速度（≈9.8 m/s²）がZ軸に明確に現れるが、walking/running/stairs時には重力が見えていない。
**疑問**: X, Y, Z軸は動作ごとに方向が異なるのか？

## 分析手法

### 1. 合成加速度の大きさ分析
sqrt(X² + Y² + Z²)を計算し、各動作での加速度の大きさ分布を比較

### 2. サンプルごとの平均加速度ベクトル分析
各サンプルの平均加速度を3軸で比較し、重力方向のばらつきを確認

### 3. 動的加速度の分離
- 総加速度 = 重力加速度 + 動的加速度
- 動的加速度 = 各時刻の加速度 - サンプル内平均加速度

### 4. 時系列での加速度の大きさ変化
動作中の加速度ベクトルの大きさが時間とともにどう変化するか確認

## 分析結果

### 1. 加速度の大きさ統計（100サンプル）

```
動作       平均合成加速度   動的加速度の平均
idle       9.757           0.749        ← 重力のみ！
stairs     11.332          6.501
walking    12.884          7.887
running    17.029          15.497       ← 動的加速度が重力を超える
```

### 2. サンプルごとの平均加速度ベクトルの範囲（30サンプル）

```
動作      X軸範囲           Y軸範囲            Z軸範囲
idle     [-0.77, 0.56]    [-0.13, 6.77]     [7.03, 9.78]   ← Z軸に重力集中
running  [-5.95, 10.19]   [5.18, 10.23]     [-2.11, 5.67]  ← ばらつき大
walking  [-4.53, 1.83]    [-11.68, -7.94]   [-3.56, 0.52]  ← Y軸が安定
stairs   [-3.44, 2.74]    [-12.04, -7.43]   [-3.89, 0.27]  ← Y軸が安定
```

## 結論

### 主要な発見

**1. 座標系は動作ごとに異なるのではなく、スマートフォンの向きが動作によって異なる**

- **Idle時**: スマートフォンが机の上など、Z軸が上向きで安定
  - Z軸に重力が集中（7.03～9.78 m/s²）
  - X, Y軸はほぼ0

- **Walking/Stairs時**: スマートフォンがポケットに入っている可能性
  - Y軸が-12～-8 m/s²で比較的安定
  - Z軸が-4～0 m/s²で比較的安定
  - 重力方向がある程度一定（ポケット内の向き）

- **Running時**: スマートフォンの向きが不安定
  - X, Y, Z軸すべてでばらつきが大きい
  - 激しい動きにより重力方向が一定しない

**2. 動作中は動的加速度が重力加速度を上回る**

```
idle:    動的加速度 ≈ 0.7 m/s²  << 重力加速度（9.8 m/s²）
stairs:  動的加速度 ≈ 6.5 m/s²
walking: 動的加速度 ≈ 7.9 m/s²
running: 動的加速度 ≈ 15.5 m/s² >> 重力加速度（9.8 m/s²）
```

- Running時の動的加速度は重力の1.6倍
- これが重力成分を「見えなく」している主要因

**3. 観測される加速度 = 重力加速度 + 動的加速度**

- Idle: 合成加速度 ≈ 9.8 m/s²（重力のみ）
- Walking: 合成加速度 ≈ 12.9 m/s²（√(9.8² + 7.9²) ≈ 12.6）
- Running: 合成加速度 ≈ 17.0 m/s²（√(9.8² + 15.5²) ≈ 18.3）

### 実験20251120_03の結論の修正

**修正前**: X=左右、Y=前後、Z=上下（固定座標系）

**修正後**:
- X, Y, Z軸は**スマートフォンに固定された座標系**
- **動作によってスマートフォンの向きが異なる**:
  - Idle: Z軸が上向き
  - Walking/Stairs: Y軸が前方向（下向き）、ポケット内で安定
  - Running: 向きが不安定、激しく変化

- **重力は常に存在するが、動的加速度により隠される**
  - 合成加速度の大きさは常に9.8 m/s²以上
  - 動作が激しいほど動的加速度が大きく、重力成分の寄与が相対的に小さくなる

## モデリングへの示唆

### 重要な特徴量

1. **合成加速度の大きさ**
   - sqrt(X² + Y² + Z²)
   - Idle: ≈9.8, Walking: ≈12.9, Running: ≈17.0
   - 動作の強度を表す有効な特徴量

2. **動的加速度成分**
   - 各時刻の加速度 - サンプル内平均
   - 重力成分を除去した純粋な動き

3. **加速度の大きさの標準偏差**
   - 動きの変動の大きさを表す
   - Running > Walking > Stairs > Idle

4. **平均加速度ベクトル**
   - 重力方向の推定
   - スマートフォンの向きの情報

### 特徴量設計の方針

- ❌ 固定座標系を仮定した特徴量（X=左右、Y=前後、Z=上下）
- ✓ 座標系に依存しない特徴量
  - 加速度の大きさ
  - 軸間の相関
  - 周波数成分
  - 動的加速度の統計量

## 生成ファイル
- output/01_magnitude_distribution.png: 各動作の合成加速度分布
- output/02_gravity_direction_scatter.png: サンプルごとの平均加速度ベクトル
- output/03_magnitude_time_series.png: 合成加速度の時系列
- output/04_dynamic_vs_total.png: 総加速度 vs 動的加速度
